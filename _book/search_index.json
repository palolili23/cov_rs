[
["smoke.html", "Chapter 9 Smoke anything", " Chapter 9 Smoke anything Source: https://epi-wiki.erasmusmc.nl/wiki/ergowiki/index.php/Alcohol Import data for all cohorts smoke1_1 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;e1_intvw_SMOKING_(23-nov-2011).sav&quot;)) smoke1_2 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;e2_intvw_SMOKING_(23-nov-2011).sav&quot;)) smoke1_3 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;e3_intvw_SMOKING_(11-nov-2011).sav&quot;)) smoke1_4 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;e4_intvw_SMOKING_(04-nov-2011).sav&quot;)) smoke1_5 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;e5_intvw_SMOKING_(04-sep-2014).sav&quot;)) smoke2_1 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;ep_intvw_SMOKING_(30-sep-2011).sav&quot;)) smoke3_1 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;ej_intvw_SMOKING_(28-mar-2011).sav&quot;)) smoke1_6 &lt;- read_sav(here::here(&quot;00_raw_data&quot;, &quot;smoke&quot;, &quot;e6_intvw_SMOKING_(20-feb-2017).sav&quot;)) Split datasets: # 1. Separate smoke1_4 into rs1, rs2 smoke2_2 &lt;- smoke1_4 %&gt;% filter(rs_cohort == 2) smoke1_4 &lt;- smoke1_4 %&gt;% filter(rs_cohort == 1) # 2. Separate smoke1_5 into rs1, rs2, rs3 smoke3_2 &lt;- smoke1_5 %&gt;% filter(rs_cohort == 3) smoke2_3 &lt;- smoke1_5 %&gt;% filter(rs_cohort == 2) smoke1_5 &lt;- smoke1_5 %&gt;% filter(rs_cohort == 1) # 3. Separate smoke1_6 into rs1 and rs2 smoke1_6 &lt;- smoke1_6 %&gt;% filter(rs_cohort == 1) smoke2_4 &lt;- smoke1_6 %&gt;% filter(rs_cohort == 2) Merge the data for all visits, by cohort: ### Merge RSI smoke1 &lt;- list(smoke1_1, smoke1_2, smoke1_3, smoke1_4, smoke1_5, smoke1_6) rs1_smoke&lt;- reduce(smoke1, left_join, by = c(&quot;ergoid&quot;, &quot;rs_cohort&quot;)) ### Merge RS2 smoke2 &lt;- list(smoke2_1, smoke2_2, smoke2_3, smoke2_4) rs2_smoke &lt;- reduce(smoke2, left_join, by = c(&quot;ergoid&quot;, &quot;rs_cohort&quot;)) ### Merge RS3 rs3_smoke &lt;- smoke3_1 %&gt;% left_join(smoke3_2, by= c(&quot;ergoid&quot;, &quot;rs_cohort&quot;)) Create variable smoke (0: never, 1: former, 2: current, NA) using the multiple questions related to smoking habits. rs1_smoke &lt;- rs1_smoke%&gt;% mutate(smoke1 = ifelse((e1_ai7_20 == 0 &amp; e1_ai7_30 == 0), 0, NA), smoke1 = ifelse((e1_ai7_20 == 0 &amp; e1_ai7_30 == 1), 1, smoke1), smoke1 = ifelse(e1_ai7_20 == 1, 2, smoke1), smoke2 = ifelse(e2_b0cg == 3 &amp; e2_b0pi == 3 &amp; e2_b0ct == 3, 0, NA), smoke2 = ifelse((e2_b0cg == 2 | e2_b0pi == 2 | e2_b0ct == 2), 1, smoke2), smoke2 = ifelse((e2_b0cg == 1 | e2_b0pi == 1 | e2_b0ct == 1), 2, smoke2), smoke3 = ifelse(e3_cicg == 0 &amp; e3_cipi == 0 &amp; e3_cict == 0 &amp; e3_cictps == 0, 0, NA), smoke3 = ifelse((e3_cicg == 1 |e3_cipi == 1 |(e3_cict == 0 &amp; e3_cictps == 1)), 1, smoke3), smoke3 = ifelse((e3_cicg == 2 |e3_cicg == 3 | e3_cipi == 2 | e3_cipi == 3 | e3_cict == 1), 2, smoke3), smoke4 = ifelse(e4_dicg == 0 &amp; e4_dipi == 0 &amp; e4_dict == 0, 0, NA), smoke4 = ifelse((e4_dicg == 1 |e4_dipi == 1 | e4_dict == 2 | e4_dict == 3), 1, smoke4), smoke4 = ifelse((e4_dicg == 2 |e4_dicg == 3 | e4_dipi == 2 | e4_dipi == 3 | e4_dict == 1), 2, smoke4), smoke5 = ifelse(e5_EILF6 == 0 &amp; e5_EILFE == 0 &amp; e5_EILF5 == 0 &amp; e5_EILF4 == 0, 0, NA), smoke5 = ifelse(((e5_EILF6 == 0 &amp; e5_EILFE == 1)| e5_EILF5 == 1 | e5_EILF4 == 1 | e5_EILF4 == 2 | e5_EILF4 == 3), 1, smoke5), smoke5 = ifelse((e5_EILF6 == 1 | e5_EILF5 == 2 | e5_EILF4 == 4 | e5_EILF4 == 5 | e5_EILF4 == 6), 2, smoke5), smoke6 = ifelse((e6_EILF6 == 0 &amp; e6_EILSE5 == 0 &amp; e6_EILF5 == 0 &amp; e6_EILF4 == 0), 0, NA), smoke6 = ifelse(((e6_EILF6 == 0 &amp; (e6_EILSE5 == 1 |e6_EILSE5 == 2))| e6_EILF5 == 1 | e6_EILF4 == 1 | e6_EILF4 == 2 | e6_EILF4 == 3), 1, smoke6), smoke6 = ifelse((e6_EILF6 == 1 | e6_EILF5 == 2 | e6_EILF4 == 4 | e6_EILF4 == 5 | e6_EILF4 == 6), 2, smoke6)) %&gt;% select(ergoid, smoke1, smoke2, smoke3, smoke4, smoke5) rs2_smoke &lt;- rs2_smoke%&gt;% mutate(smoke3 = ifelse(ep_lf4 == 0 &amp; ep_lf5 == 0 &amp; ep_lf6 == 0 &amp; ep_lf6e == 0, 0, NA), smoke3 = ifelse((ep_lf4 == 1 | ep_lf5 == 1 | (ep_lf6 == 0 &amp; ep_lf6e == 1)), 1, smoke3), smoke3 = ifelse((ep_lf4 == 2 | ep_lf5 == 2 | ep_lf6 == 1), 2, smoke3), smoke4 = ifelse(e4_dicg == 0 &amp; e4_dipi == 0 &amp; e4_dict == 0, 0, NA), smoke4 = ifelse((e4_dicg == 1 |e4_dipi == 1 | e4_dict == 2 | e4_dict == 3), 1, smoke4), smoke4 = ifelse((e4_dicg == 2 |e4_dicg == 3 | e4_dipi == 2 | e4_dipi == 3 | e4_dict == 1), 2, smoke4), smoke5 = ifelse(e5_EILF6 == 0 &amp; e5_EILFE == 0 &amp; e5_EILF5 == 0 &amp; e5_EILF4 == 0, 0, NA), smoke5 = ifelse(((e5_EILF6 == 0 &amp; e5_EILFE == 1)| e5_EILF5 == 1 | e5_EILF4 == 1 | e5_EILF4 == 2 | e5_EILF4 == 3), 1, smoke5), smoke5 = ifelse((e5_EILF6 == 1 | e5_EILF5 == 1 | e5_EILF4 == 4 | e5_EILF4 == 5 | e5_EILF4 == 6), 2, smoke5), smoke6 = ifelse(e6_EILF6 == 0 &amp; e6_EILSE5 == 0 &amp; e6_EILF5 == 0 &amp; e6_EILF4 == 0, 0, NA), smoke6 = ifelse(((e6_EILF6 == 0 &amp; (e6_EILSE5 == 1 |e6_EILSE5 == 2))| e6_EILF5 == 1 | e6_EILF4 == 1 | e6_EILF4 == 2 | e6_EILF4 == 3), 1, smoke6), smoke6 = ifelse((e6_EILF6 == 1 | e6_EILF5 == 2 | e6_EILF4 == 4 | e6_EILF4 == 5 | e6_EILF4 == 6), 2, smoke6)) %&gt;% select(ergoid, rs_cohort, smoke3, smoke4, smoke5, smoke6) rs3_smoke &lt;- rs3_smoke%&gt;% mutate(smoke4 = ifelse(ej_yilf4 == 0 &amp; ej_yilf5 == 0 &amp; ej_yilf6 == 0 &amp; ej_yilfe == 0, 0, NA), smoke4 = ifelse((ej_yilf4 == 1 | ej_yilf4 == 2 | ej_yilf4 == 3 | ej_yilf5 == 1 | (ej_yilf6 == 0 &amp; ej_yilfe == 1)), 1, smoke4), smoke4 = ifelse((ej_yilf4 == 4 | ej_yilf4 == 5 | ej_yilf4 == 6 | ej_yilf5 == 2 | ej_yilf6 == 1), 2, smoke4), smoke5 = ifelse(e5_EILF6 == 0 &amp; e5_EILFE == 0 &amp; e5_EILF5 == 0 &amp; e5_EILF4 == 0, 0, NA), smoke5 = ifelse(((e5_EILF6 == 0 &amp; e5_EILFE == 1)| e5_EILF5 == 1 | e5_EILF4 == 1 | e5_EILF4 == 2 | e5_EILF4 == 3), 1, smoke5), smoke5 = ifelse((e5_EILF6 == 1 | e5_EILF5 == 1 | e5_EILF4 == 4 | e5_EILF4 == 5 | e5_EILF4 == 6), 2, smoke5)) %&gt;% select(ergoid, rs_cohort, smoke4, smoke5) Bind , the cohorts. Since the variable names are consistent through the datasets. smoke &lt;- rs1_smoke %&gt;% bind_rows(rs2_smoke) %&gt;% bind_rows(rs3_smoke) Export the variable to a clean_data folder. export(smoke, here::here(&quot;02_clean_data&quot;, &quot;smoke.Rdata&quot;)) "]
]
